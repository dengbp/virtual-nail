# æµ‹è¯•è„šæœ¬å¯¹æ¯”è¯´æ˜

## è„šæœ¬æ–‡ä»¶

| ç‰ˆæœ¬ | æ–‡ä»¶å | æè¿° |
|------|--------|------|
| åŸå§‹ç‰ˆæœ¬ | `test_run_purecolor.py` | æµ‹è¯•ç”Ÿäº§ç‰ˆæœ¬çš„å¤„ç†å‡½æ•° |
| ä¼˜åŒ–ç‰ˆæœ¬ | `test_run_purecolor_optimized.py` | æµ‹è¯•ä¼˜åŒ–ç‰ˆæœ¬çš„å¤„ç†å‡½æ•° |

## ä¸»è¦å·®å¼‚å¯¹æ¯”

### 1. å¯¼å…¥æ¨¡å—å·®å¼‚

#### åŸå§‹ç‰ˆæœ¬
```python
from nail_sdxl_inpaint_purecolor import process_one, input_dir, output_mask_dir, output_color_dir, output_final_dir
```

#### ä¼˜åŒ–ç‰ˆæœ¬
```python
from nail_sdxl_inpaint_purecolor_optimized_v2 import process_one_optimized_v2, preload_models
```

### 2. æ–°å¢åŠŸèƒ½

#### ä¼˜åŒ–ç‰ˆæœ¬æ–°å¢å‚æ•°
```python
parser.add_argument("--preload", action="store_true", help="æ˜¯å¦é¢„åŠ è½½æ¨¡å‹ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰")
```

#### ä¼˜åŒ–ç‰ˆæœ¬æ–°å¢åŠŸèƒ½
- âœ… **æ¨¡å‹é¢„åŠ è½½**ï¼šå¯é€‰çš„æ¨¡å‹é¢„åŠ è½½åŠŸèƒ½
- âœ… **æ›´è¯¦ç»†çš„è¿›åº¦æ˜¾ç¤º**ï¼šæ˜¾ç¤ºå¤„ç†è¿›åº¦å’ŒçŠ¶æ€
- âœ… **é”™è¯¯å¤„ç†å¢å¼º**ï¼šæ›´å¥½çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æç¤º
- âœ… **æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥**ï¼šæ£€æŸ¥å‚è€ƒå›¾æ˜¯å¦å­˜åœ¨
- âœ… **å¤„ç†çŠ¶æ€åé¦ˆ**ï¼šæ˜¾ç¤ºæˆåŠŸ/å¤±è´¥çŠ¶æ€

### 3. ä½¿ç”¨æ–¹å¼å¯¹æ¯”

#### åŸå§‹ç‰ˆæœ¬
```bash
# åŸºæœ¬ä½¿ç”¨
python test_run_purecolor.py

# æŒ‡å®šè¾“å…¥ç›®å½•
python test_run_purecolor.py --input_dir data/test_images

# æŒ‡å®šè¾“å‡ºç›®å½•
python test_run_purecolor.py --output_final_dir data/output/final
```

#### ä¼˜åŒ–ç‰ˆæœ¬
```bash
# åŸºæœ¬ä½¿ç”¨ï¼ˆä¸é¢„åŠ è½½æ¨¡å‹ï¼‰
python test_run_purecolor_optimized.py

# é¢„åŠ è½½æ¨¡å‹ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰
python test_run_purecolor_optimized.py --preload

# æŒ‡å®šè¾“å…¥ç›®å½•
python test_run_purecolor_optimized.py --input_dir data/test_images

# æŒ‡å®šè¾“å‡ºç›®å½•
python test_run_purecolor_optimized.py --output_final_dir data/output/final

# å®Œæ•´å‚æ•°ç¤ºä¾‹
python test_run_purecolor_optimized.py --preload --input_dir data/test_images --output_final_dir data/output/final
```

### 4. è¾“å‡ºä¿¡æ¯å¯¹æ¯”

#### åŸå§‹ç‰ˆæœ¬è¾“å‡º
```
å‚è€ƒå›¾è·¯å¾„: data/reference/reference.jpg
æœªæ‰¾åˆ°æ©ç : data/test_masks/test_mask_input_mask.pngï¼Œä½¿ç”¨ UÂ²-Net ç”Ÿæˆæ©ç 
æ©ç å·²ç”Ÿæˆå¹¶ä¿å­˜åˆ°: data/test_masks/test_mask_input_mask.png
```

#### ä¼˜åŒ–ç‰ˆæœ¬è¾“å‡º
```
============================================================
ç¾ç”²æ¸²æŸ“ä¼˜åŒ–ç‰ˆæœ¬æµ‹è¯•è„šæœ¬
============================================================
å‚è€ƒå›¾è·¯å¾„: data/reference/reference.jpg
è·³è¿‡æ¨¡å‹é¢„åŠ è½½ï¼ˆé¦–æ¬¡å¤„ç†æ—¶ä¼šæœ‰åŠ è½½å»¶è¿Ÿï¼‰
åˆå§‹åŒ–æ©ç ç”Ÿæˆå™¨...
æ©ç ç”Ÿæˆå™¨åˆå§‹åŒ–å®Œæˆ
æ‰¾åˆ° 1 ä¸ªå›¾åƒæ–‡ä»¶

==================================================
å¤„ç†ç¬¬ 1/1 ä¸ªå›¾åƒ: test.jpg
==================================================
ä½¿ç”¨ç°æœ‰æ©ç : data/test_masks/test_mask_input_mask.png
å¼€å§‹å¤„ç†å›¾åƒ: test.jpg
âœ… å¤„ç†å®Œæˆ: data/output/final/test_final.png

============================================================
æ‰€æœ‰å›¾åƒå¤„ç†å®Œæˆï¼
æœ€ç»ˆç»“æœä¿å­˜åœ¨: data/output/final
============================================================
```

### 5. åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”

| åŠŸèƒ½ | åŸå§‹ç‰ˆæœ¬ | ä¼˜åŒ–ç‰ˆæœ¬ |
|------|----------|----------|
| åŸºæœ¬å›¾åƒå¤„ç† | âœ… | âœ… |
| æ©ç è‡ªåŠ¨ç”Ÿæˆ | âœ… | âœ… |
| æ¨¡å‹é¢„åŠ è½½ | âŒ | âœ… |
| è¯¦ç»†è¿›åº¦æ˜¾ç¤º | âŒ | âœ… |
| é”™è¯¯å¤„ç†å¢å¼º | âŒ | âœ… |
| æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥ | âŒ | âœ… |
| å¤„ç†çŠ¶æ€åé¦ˆ | âŒ | âœ… |
| ç¾è§‚çš„è¾“å‡ºæ ¼å¼ | âŒ | âœ… |

### 6. æ€§èƒ½å¯¹æ¯”

#### é¦–æ¬¡è¿è¡Œ
- **åŸå§‹ç‰ˆæœ¬**ï¼šé¦–æ¬¡å¤„ç†æ—¶ä¼šæœ‰æ¨¡å‹åŠ è½½å»¶è¿Ÿ
- **ä¼˜åŒ–ç‰ˆæœ¬**ï¼šä½¿ç”¨ `--preload` å‚æ•°å¯é¿å…é¦–æ¬¡å»¶è¿Ÿ

#### è¿ç»­å¤„ç†
- **åŸå§‹ç‰ˆæœ¬**ï¼šæ¯æ¬¡å¤„ç†éƒ½ä½¿ç”¨ç›¸åŒçš„æ¨¡å‹å®ä¾‹
- **ä¼˜åŒ–ç‰ˆæœ¬**ï¼šä½¿ç”¨å…¨å±€æ¨¡å‹å®ä¾‹ï¼Œé¿å…é‡å¤åŠ è½½

### 7. ä½¿ç”¨å»ºè®®

#### å¼€å‘æµ‹è¯•
```bash
# å¿«é€Ÿæµ‹è¯•ï¼Œä¸é¢„åŠ è½½æ¨¡å‹
python test_run_purecolor_optimized.py
```

#### ç”Ÿäº§ç¯å¢ƒ
```bash
# é¢„åŠ è½½æ¨¡å‹ï¼Œé¿å…é¦–æ¬¡è¯·æ±‚å»¶è¿Ÿ
python test_run_purecolor_optimized.py --preload
```

#### æ‰¹é‡å¤„ç†
```bash
# å¤„ç†å¤§é‡å›¾åƒæ—¶ä½¿ç”¨é¢„åŠ è½½
python test_run_purecolor_optimized.py --preload --input_dir data/batch_images
```

## æ€»ç»“

ä¼˜åŒ–ç‰ˆæœ¬çš„æµ‹è¯•è„šæœ¬åœ¨ä¿æŒåŸæœ‰åŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ï¼š

1. **ğŸš€ æ€§èƒ½ä¼˜åŒ–**ï¼šæ¨¡å‹é¢„åŠ è½½åŠŸèƒ½
2. **ğŸ“Š æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ**ï¼šè¯¦ç»†çš„è¿›åº¦æ˜¾ç¤ºå’ŒçŠ¶æ€åé¦ˆ
3. **ğŸ›¡ï¸ æ›´å¼ºçš„ç¨³å®šæ€§**ï¼šå¢å¼ºçš„é”™è¯¯å¤„ç†å’Œæ–‡ä»¶æ£€æŸ¥
4. **ğŸ¨ æ›´ç¾è§‚çš„è¾“å‡º**ï¼šæ ¼å¼åŒ–çš„è¾“å‡ºä¿¡æ¯

ä¸¤ä¸ªè„šæœ¬å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼Œäº’ä¸å¹²æ‰°ï¼Œæ»¡è¶³ä¸åŒçš„ä½¿ç”¨åœºæ™¯éœ€æ±‚ã€‚ 