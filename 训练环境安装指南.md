# è®­ç»ƒç¯å¢ƒå®‰è£…æŒ‡å—

## ğŸ¯ ç›®æ ‡
åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„è®­ç»ƒç¯å¢ƒï¼Œä¸å½±å“ç°æœ‰çš„æ¨ç†ç¯å¢ƒã€‚

## ğŸ“ ç¯å¢ƒç»“æ„
```
nail-color-preview/
â”œâ”€â”€ train_env/              # ç‹¬ç«‹è®­ç»ƒç¯å¢ƒ
â”œâ”€â”€ setup_train_env.bat     # ç¯å¢ƒè®¾ç½®è„šæœ¬
â”œâ”€â”€ start_training.bat      # è®­ç»ƒå¯åŠ¨è„šæœ¬
â”œâ”€â”€ train_u2net_pytorch.py # è®­ç»ƒè„šæœ¬
â””â”€â”€ å…¶ä»–æ¨ç†ç›¸å…³æ–‡ä»¶...
```

## ğŸš€ å®‰è£…æ­¥éª¤

### 1. æ¿€æ´»è®­ç»ƒç¯å¢ƒ
```bash
# æ¿€æ´»è®­ç»ƒç¯å¢ƒ
train_env\Scripts\activate

# éªŒè¯ç¯å¢ƒ
python -c "import sys; print('Pythonè·¯å¾„:', sys.executable)"
```

### 2. å®‰è£…CUDAç‰ˆæœ¬çš„PyTorch

#### æ–¹æ³•1ï¼šå®˜æ–¹æºï¼ˆæ¨èï¼‰
```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

#### æ–¹æ³•2ï¼šå›½å†…é•œåƒæº
```bash
pip install torch torchvision torchaudio -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### 3. å®‰è£…å…¶ä»–ä¾èµ–
```bash
pip install scikit-learn albumentations matplotlib tqdm opencv-python
```

### 4. éªŒè¯å®‰è£…
```bash
python -c "import torch; print('PyTorchç‰ˆæœ¬:', torch.__version__); print('CUDAå¯ç”¨:', torch.cuda.is_available()); print('GPUæ•°é‡:', torch.cuda.device_count() if torch.cuda.is_available() else 0)"
```

## ğŸ® ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨è„šæœ¬
```bash
# è®¾ç½®ç¯å¢ƒ
setup_train_env.bat

# å¯åŠ¨è®­ç»ƒ
start_training.bat
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨æ“ä½œ
```bash
# 1. æ¿€æ´»ç¯å¢ƒ
train_env\Scripts\activate

# 2. å¼€å§‹è®­ç»ƒ
python train_u2net_pytorch.py
```

## ğŸ“Š é¢„æœŸç»“æœ

### æˆåŠŸå®‰è£…ååº”è¯¥çœ‹åˆ°ï¼š
```
PyTorchç‰ˆæœ¬: 2.x.x+cu121
CUDAå¯ç”¨: True
GPUæ•°é‡: 1
```

### è®­ç»ƒé…ç½®ï¼š
- **GPU**: NVIDIA RTX A5000 (24GB)
- **æ‰¹æ¬¡å¤§å°**: 4
- **æœ€å¤§å°ºå¯¸**: 1024
- **æ•°æ®é‡**: 1606å¼ å›¾åƒ
- **é¢„æœŸæ—¶é—´**: 8-16å°æ—¶

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œé—®é¢˜**: å¦‚æœä¸‹è½½è¶…æ—¶ï¼Œå¯ä»¥å°è¯•ï¼š
   - ä½¿ç”¨VPN
   - æ›´æ¢é•œåƒæº
   - æ‰‹åŠ¨ä¸‹è½½whlæ–‡ä»¶

2. **ç¯å¢ƒéš”ç¦»**: 
   - è®­ç»ƒç¯å¢ƒå®Œå…¨ç‹¬ç«‹
   - ä¸ä¼šå½±å“æ¨ç†ç¯å¢ƒ
   - å¯ä»¥åŒæ—¶è¿è¡Œ

3. **GPUä½¿ç”¨**:
   - ç¡®ä¿æ¨ç†å’Œè®­ç»ƒä¸åŒæ—¶ä½¿ç”¨GPU
   - å¯ä»¥è®¾ç½®CUDA_VISIBLE_DEVICESæ§åˆ¶GPUä½¿ç”¨

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šCUDAä¸å¯ç”¨
```bash
# æ£€æŸ¥GPU
nvidia-smi

# é‡æ–°å®‰è£…CUDAç‰ˆæœ¬PyTorch
pip uninstall torch torchvision torchaudio
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

### é—®é¢˜2ï¼šä¾èµ–åŒ…å®‰è£…å¤±è´¥
```bash
# å‡çº§pip
python -m pip install --upgrade pip

# ä½¿ç”¨å›½å†…é•œåƒ
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple/ åŒ…å
```

### é—®é¢˜3ï¼šå†…å­˜ä¸è¶³
```bash
# å‡å°‘æ‰¹æ¬¡å¤§å°
# ä¿®æ”¹ train_u2net_pytorch.py ä¸­çš„ batch_size = 2
```

## ğŸ“ˆ è®­ç»ƒç›‘æ§

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šç”Ÿæˆï¼š
- `train_u2net_detailed.log` - è¯¦ç»†è®­ç»ƒæ—¥å¿—
- `training_curves.png` - è®­ç»ƒæ›²çº¿å›¾
- `models/u2net_nail_best.pth` - æœ€ä¼˜æ¨¡å‹

## ğŸ‰ å®Œæˆ

å®‰è£…å®Œæˆåï¼Œæ‚¨å°±å¯ä»¥åœ¨ç‹¬ç«‹ç¯å¢ƒä¸­è¿›è¡Œè®­ç»ƒï¼Œä¸ä¼šå½±å“ç°æœ‰çš„æ¨ç†ç¯å¢ƒï¼ 